{% extends "layout.html" %}

{% block title %}{{ _('Loja') }} - BIGODETEXAS - XBOX{% endblock %}

{% block extra_head %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/shop.css') }}">
{% endblock %}

{% block content %}
<div class="container shop-container">
    <!-- Header da Loja -->
    <div class="shop-header">
        <h1 class="shop-title"><i class="ri-store-3-line"></i> {{ _('Loja BIGODETEXAS - XBOX') }}</h1>
        <p class="shop-subtitle">{{ _('Compre itens com DZCoins e receba no mapa!') }}</p>
    </div>

    <!-- Filtros e Busca -->
    <div class="shop-controls">
        <div class="search-box">
            <i class="ri-search-line search-icon"></i>
            <input type="text" id="search-input" class="search-input" placeholder="{{ _('Buscar item...') }}">
        </div>
        <select id="sort-select" class="category-filter">
            <option value="name">{{ _('Ordenar por Nome') }}</option>
            <option value="price-asc">{{ _('Preço: Menor → Maior') }}</option>
            <option value="price-desc">{{ _('Preço: Maior → Menor') }}</option>
        </select>
    </div>

    <!-- Categorias (Tabs) -->
    <div class="categories" style="display: flex; gap: 0.5rem; flex-wrap: wrap; margin-bottom: 2rem;">
        <button class="category-filter active" data-category="all">{{ _('Todos') }}</button>
        <button class="category-filter" data-category="armas"><i class="ri-crosshair-2-line"></i> {{ _('Armas')
            }}</button>
        <button class="category-filter" data-category="municao"><i class="ri-disc-line"></i> {{ _('Munição') }}</button>
        <button class="category-filter" data-category="carregadores"><i class="ri-archive-line"></i> {{
            _('Carregadores') }}</button>
        <button class="category-filter" data-category="acessorios"><i class="ri-settings-4-line"></i> {{ _('Acessórios')
            }}</button>
        <button class="category-filter" data-category="armadilhas"><i class="ri-alert-line"></i> {{ _('Armadilhas')
            }}</button>
        <button class="category-filter" data-category="medico"><i class="ri-first-aid-kit-line"></i> {{ _('Médico')
            }}</button>
        <button class="category-filter" data-category="comidas"><i class="ri-restaurant-line"></i> {{ _('Comida')
            }}</button>
        <button class="category-filter" data-category="roupas"><i class="ri-shirt-line"></i> {{ _('Roupas') }}</button>
        <button class="category-filter" data-category="mochilas"><i class="ri-shopping-bag-3-line"></i> {{ _('Mochilas')
            }}</button>
        <button class="category-filter" data-category="construcao"><i class="ri-hammer-line"></i> {{ _('Construção')
            }}</button>
        <button class="category-filter" data-category="ferramentas"><i class="ri-tools-line"></i> {{ _('Ferramentas')
            }}</button>
        <button class="category-filter" data-category="veiculos"><i class="ri-roadster-line"></i> {{ _('Veículos')
            }}</button>
        <button class="category-filter" data-category="cacador"><i class="ri-compass-3-line"></i> {{ _('Caçador')
            }}</button>
    </div>

    <!-- Grid de Itens -->
    <div id="items-grid" class="items-grid">
        <!-- Itens serão carregados aqui via JavaScript -->
    </div>
</div>

<!-- Modal do Carrinho -->
<div id="cart-modal" class="cart-modal">
    <div class="cart-header">
        <h2 class="cart-title"><i class="ri-shopping-cart-2-line"></i> {{ _('Carrinho') }}</h2>
        <button class="close-cart" id="close-cart">&times;</button>
    </div>
    <div class="cart-items" id="cart-items">
        <!-- Itens do carrinho aqui -->
    </div>
    <div class="cart-footer">
        <div class="cart-total">
            <span>{{ _('Total:') }}</span>
            <span id="cart-total">0 DZCoins</span>
        </div>
        <button class="btn btn-secondary" id="clear-cart" style="width: 100%; margin-bottom: 1rem;">{{ _('Limpar
            Carrinho') }}</button>
        <button class="checkout-btn" id="checkout-btn">{{ _('Finalizar Compra') }}</button>
    </div>
</div>

<!-- Modal de Upload de Imagem (Admin) -->
<div id="upload-modal" class="modal"
    style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2000; align-items: center; justify-content: center;">
    <div class="modal-content"
        style="background: #1a1a1a; padding: 2rem; border-radius: 1rem; width: 90%; max-width: 500px; position: relative; border: 1px solid rgba(255,255,255,0.1);">
        <button onclick="closeUploadModal()"
            style="position: absolute; top: 1rem; right: 1rem; background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer;">&times;</button>
        <h2 style="margin-bottom: 1.5rem;">{{ _('Alterar Imagem do Item') }}</h2>
        <h3 id="upload-item-name" style="color: var(--accent); margin-bottom: 1rem;">{{ _('Nome do Item') }}</h3>

        <input type="hidden" id="upload-item-id">

        <div style="margin-bottom: 1.5rem;">
            <label style="display: block; margin-bottom: 0.5rem;">{{ _('Selecione uma imagem (PNG, JPG, GIF):')
                }}</label>
            <input type="file" id="upload-file" accept="image/*"
                style="width: 100%; padding: 0.5rem; background: rgba(255,255,255,0.05); border-radius: 0.5rem; color: white;">
        </div>

        <button onclick="submitImageUpload()"
            style="width: 100%; padding: 1rem; background: var(--accent); border: none; border-radius: 0.5rem; font-weight: bold; cursor: pointer;">
            {{ _('Enviar Imagem') }}
        </button>
    </div>
</div>

<!-- Botão de Carrinho Flutuante -->
<div class="cart-float" id="cart-float-btn">
    <i class="ri-shopping-cart-line"></i>
    <div class="cart-count-badge" id="cart-count">0</div>
</div>
{% endblock %}

{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/shop.js') }}"></script>
{% endblock %}