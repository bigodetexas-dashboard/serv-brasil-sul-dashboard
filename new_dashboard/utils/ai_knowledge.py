"""
BigodeBot AI - Base de Conhecimento Expandida
Conhecimento detalhado sobre o servidor, DayZ, regras e troubleshooting
"""

KNOWLEDGE_BASE = """
# CONHECIMENTO DO SERVIDOR BIGODE TEXAS

## 1. INFORMAÃ‡Ã•ES BÃSICAS DO SERVIDOR

### ConfiguraÃ§Ã£o
- **Nome:** SERV. BRASIL SUL - XBOX
- **Mapa:** Chernarus (versÃ£o inverno/editada)
- **Plataforma:** Xbox Series X/S e Xbox One
- **Tipo:** PvP com zonas seguras
- **Moeda:** DZ Coins
- **Wipes:** A cada 30-45 dias (anunciado com antecedÃªncia)

### HorÃ¡rios de Pico
- Semana: 19h-23h (horÃ¡rio de BrasÃ­lia)
- Fim de semana: 14h-02h
- Eventos especiais: Anunciados no Discord

## 2. SISTEMA DE ECONOMIA

### Como Ganhar DZ Coins
1. **Daily Reward:** 100 coins por dia (comando /daily)
2. **Kills PvP:** 50-150 coins por eliminaÃ§Ã£o (varia com distÃ¢ncia)
3. **Eventos:** 500-2000 coins (depende do evento)
4. **MissÃµes:** 200-800 coins
5. **Venda de itens raros:** NegociÃ¡vel com players
6. **Bounties:** Eliminar alvos marcados (100-1000 coins)

### Loja (Shop)
- **Armas:** 500-3000 coins
- **VeÃ­culos:** 2000-8000 coins
- **Suprimentos:** 50-500 coins
- **Itens raros:** 1000-5000 coins
- **Entrega:** AtÃ© 30 segundos (sistema de fila)

### Banco do ClÃ£
- Membros podem depositar coins
- LÃ­der e moderadores podem sacar
- Usado para compras coletivas
- HistÃ³rico de transaÃ§Ãµes disponÃ­vel

## 3. SISTEMA DE CLÃƒS

### CriaÃ§Ã£o de ClÃ£
- Custo: 5000 DZ Coins
- MÃ¡ximo de membros: 15
- Comando: /clan create [nome]

### Cargos
- **LÃ­der:** Controle total, pode dissolver clÃ£
- **Moderador:** Pode convidar/expulsar, gerenciar banco
- **Membro:** Pode depositar no banco, participar de guerras

### Guerras de ClÃ£
- Desafio via comando /clan war [nome_do_clÃ£]
- DuraÃ§Ã£o: 7 dias
- Pontos por kill de membro rival
- Recompensa: 10.000 coins + tÃ­tulo especial

### TerritÃ³rios
- ClÃ£s podem marcar bases no mapa
- Alarmes de invasÃ£o (notificaÃ§Ã£o no Discord)
- ProteÃ§Ã£o limitada em horÃ¡rios especÃ­ficos

## 4. REGRAS DO SERVIDOR

### Proibido (Ban Permanente)
1. **Glitches de base:** Entrar em bases por bugs
2. **DuplicaÃ§Ã£o de itens:** Qualquer mÃ©todo
3. **Teaming excessivo:** Mais de 15 pessoas juntas
4. **Toxicidade extrema:** Racismo, homofobia, ameaÃ§as
5. **Alt accounts:** Para burlar bans ou farmar coins

### Permitido
1. **KOS (Kill on Sight):** Fora das zonas seguras
2. **Roubo de bases:** Desde que sem glitch
3. **TraiÃ§Ã£o:** Faz parte do jogo
4. **Camping:** EstratÃ©gia vÃ¡lida
5. **AlianÃ§as temporÃ¡rias:** Sem limite de tempo

### Zonas Seguras
- **Trader (Comerciante):** NÃ£o pode atacar/ser atacado
- **Spawn Points:** ProteÃ§Ã£o de 5 minutos
- **Eventos:** Definido pelo admin no momento

## 5. MECÃ‚NICAS DO DAYZ (XBOX)

### SobrevivÃªncia
- **Fome:** Come a cada 30-60 min (frutas, carne, latas)
- **Sede:** Bebe a cada 20-40 min (Ã¡gua, refrigerante)
- **Temperatura:** Roupas quentes no inverno, fogueira
- **DoenÃ§as:** AntibiÃ³ticos para infecÃ§Ãµes, vitaminas para imunidade

### Combate
- **Headshot:** Dano crÃ­tico (maioria das armas = kill instantÃ¢neo)
- **Sangramento:** Use bandagens/trapos
- **Fratura:** Use tala (sticks + trapos)
- **Choque:** Epi-pen ou espere recuperar

### VeÃ­culos
- **CombustÃ­vel:** Gasolina em postos ou barris
- **Reparos:** Precisa de peÃ§as especÃ­ficas (roda, bateria, vela)
- **Dano:** ColisÃµes causam dano ao jogador e veÃ­culo
- **Despawn:** VeÃ­culos sem uso por 7 dias desaparecem

### Bases
- **ConstruÃ§Ã£o:** Precisa de pregos, tÃ¡buas, martelo
- **Cadeados:** 3 dÃ­gitos (1000 combinaÃ§Ãµes) ou 4 dÃ­gitos (10.000)
- **Raid:** PossÃ­vel com ferramentas (alicate, serra, explosivos)
- **Despawn de loot:** Itens em tendas/barris duram 45 dias

## 6. LOCALIDADES IMPORTANTES (CHERNARUS)

### Zonas Militares (PvP Intenso)
- **NWAF (Northwest Airfield):** Melhor loot militar
- **NEAF (Northeast Airfield):** Loot mÃ©dio, menos movimento
- **Tisy Military Base:** Loot top tier, muito perigoso
- **Kamensk Military Base:** Armas pesadas

### Cidades Grandes
- **Cherno:** Loot urbano, hospital
- **Elektro:** Spawn comum, hospital
- **Berezino:** Costa leste, loot mÃ©dio
- **Novo:** Spawn comum, supermercados

### Pontos de Interesse
- **Green Mountain:** Torre de rÃ¡dio, loot variado
- **Devil's Castle:** Loot militar leve
- **Zelenogorsk:** Cidade mÃ©dia, boa para comeÃ§ar

## 7. PERGUNTAS FREQUENTES (FAQ)

### "Como ganhar coins rÃ¡pido?"
1. FaÃ§a o /daily todo dia (100 coins)
2. Participe de eventos (500-2000 coins)
3. CaÃ§e bounties (100-1000 coins)
4. FaÃ§a kills em zonas militares (150 coins por kill)

### "Meu item nÃ£o chegou da loja!"
- Sistema de fila: Entrega em atÃ© 30 segundos
- Se demorar mais: Verifique /delivery status
- Se falhar: Abre ticket (serÃ¡ entregue automaticamente)

### "Como entro em um clÃ£?"
- PeÃ§a convite ao lÃ­der do clÃ£
- Ou use /clan join [nome] se houver convite aberto

### "Posso ter mais de uma base?"
- Sim, sem limite
- Mas cada base precisa de manutenÃ§Ã£o (bandeiras)

### "O que fazer se morri injustamente?"
- Abra ticket com provas (vÃ­deo/screenshot)
- Admins revisam em atÃ© 24h
- CompensaÃ§Ã£o se confirmado bug/glitch

## 8. COMANDOS ÃšTEIS

### Economia
- `/daily` - Resgatar recompensa diÃ¡ria
- `/balance` - Ver saldo de DZ Coins
- `/shop` - Abrir loja
- `/transfer [user] [valor]` - Transferir coins

### ClÃ£
- `/clan create [nome]` - Criar clÃ£ (5000 coins)
- `/clan invite [user]` - Convidar membro
- `/clan bank` - Ver banco do clÃ£
- `/clan war [clÃ£]` - Desafiar para guerra

### InformaÃ§Ãµes
- `/stats` - Ver suas estatÃ­sticas
- `/leaderboard` - Ver ranking
- `/help` - Lista de comandos
- `/ticket` - Abrir suporte

## 9. EVENTOS COMUNS

### Airdrop (Suprimento AÃ©reo)
- Acontece a cada 2-3 horas
- Loot militar de alto nÃ­vel
- Anunciado no chat 5 min antes
- LocalizaÃ§Ã£o aleatÃ³ria

### King of the Hill
- Controle uma Ã¡rea por 30 min
- Recompensa: 2000 coins + loot especial
- Anunciado 10 min antes
- PvP liberado

### Treasure Hunt (CaÃ§a ao Tesouro)
- Pistas no Discord
- Primeiro a encontrar ganha 5000 coins
- Acontece 1x por semana

### Clan Wars Weekend
- Fim de semana de guerras
- Pontos em dobro
- Recompensas especiais

## 10. TROUBLESHOOTING

### "NÃ£o consigo conectar no servidor"
1. Reinicie o jogo
2. Verifique se o servidor estÃ¡ online (Discord)
3. Limpe cache do Xbox (Settings > Storage)
4. Reinstale DayZ se persistir

### "Meu personagem sumiu"
- Wipe recente? (Anunciado no Discord)
- Morreu e nÃ£o lembra? (Cheque /stats)
- Bug raro: Abra ticket urgente

### "Fui banido injustamente"
- Leia as regras novamente
- Abra ticket de apelaÃ§Ã£o
- ForneÃ§a provas (vÃ­deos, prints)
- Admins revisam em 48h

### "Lag/Desync no servidor"
- Normal em horÃ¡rios de pico (19h-23h)
- Reinicie seu Xbox
- Use conexÃ£o cabeada (nÃ£o Wi-Fi)
- Reporte se persistir por mais de 1h

## 11. DICAS AVANÃ‡ADAS

### Para Iniciantes
1. Spawne â†’ Corra para cidade pequena
2. Pegue faca/machado primeiro (zumbis)
3. Encontre comida/Ã¡gua (prioridade)
4. Evite zonas militares no inÃ­cio
5. FaÃ§a amigos (Discord)

### Para IntermediÃ¡rios
1. Monte uma base pequena (escondida)
2. FaÃ§a rotas de loot eficientes
3. Participe de eventos
4. Entre em um clÃ£
5. Aprenda PvP (treine em zonas militares)

### Para AvanÃ§ados
1. Domine rotas de veÃ­culos
2. Lidere um clÃ£
3. Participe de guerras
4. FaÃ§a raids estratÃ©gicos
5. Ajude novatos (ganhe respeito)

## 12. ATUALIZAÃ‡Ã•ES RECENTES

### Sistema de Fila de Entrega (NOVO!)
- Compras nunca mais serÃ£o perdidas
- Entrega garantida mesmo se FTP cair
- Status em tempo real via /delivery status

### IA com RAG (NOVO!)
- IA agora sabe sobre o jogo em tempo real
- Perguntas personalizadas com seus dados
- Respostas mais precisas e Ãºteis

### Achievements System
- 18 conquistas disponÃ­veis
- Recompensas em DZ Coins
- Progresso rastreado automaticamente
"""


def get_knowledge_context(question: str) -> str:
    """
    Retorna seÃ§Ãµes relevantes da base de conhecimento baseado na pergunta

    Args:
        question: Pergunta do usuÃ¡rio

    Returns:
        Contexto relevante da base de conhecimento
    """
    question_lower = question.lower()
    relevant_sections = []

    # Mapeamento de palavras-chave para seÃ§Ãµes
    keywords_map = {
        "coins|dinheiro|grana|saldo": "## 2. SISTEMA DE ECONOMIA",
        "clÃ£|clan|grupo": "## 3. SISTEMA DE CLÃƒS",
        "regra|ban|proibido|permitido": "## 4. REGRAS DO SERVIDOR",
        "fome|sede|doenÃ§a|sobreviv": "## 5. MECÃ‚NICAS DO DAYZ",
        "local|cidade|mapa|onde": "## 6. LOCALIDADES IMPORTANTES",
        "como|ajuda|dÃºvida": "## 7. PERGUNTAS FREQUENTES",
        "comando|/": "## 8. COMANDOS ÃšTEIS",
        "evento|airdrop|guerra": "## 9. EVENTOS COMUNS",
        "bug|erro|problema|nÃ£o consigo": "## 10. TROUBLESHOOTING",
        "dica|iniciante|comeÃ§ar": "## 11. DICAS AVANÃ‡ADAS",
    }

    # Encontrar seÃ§Ãµes relevantes
    for keywords, section_title in keywords_map.items():
        if any(keyword in question_lower for keyword in keywords.split("|")):
            # Extrair seÃ§Ã£o do KNOWLEDGE_BASE
            start = KNOWLEDGE_BASE.find(section_title)
            if start != -1:
                # Encontrar prÃ³xima seÃ§Ã£o ou fim
                next_section = KNOWLEDGE_BASE.find("\n## ", start + 1)
                if next_section != -1:
                    section_content = KNOWLEDGE_BASE[start:next_section]
                else:
                    section_content = KNOWLEDGE_BASE[start:]

                relevant_sections.append(section_content.strip())

    # Se nÃ£o encontrou nada especÃ­fico, retorna informaÃ§Ãµes bÃ¡sicas
    if not relevant_sections:
        start = KNOWLEDGE_BASE.find("## 1. INFORMAÃ‡Ã•ES BÃSICAS")
        end = KNOWLEDGE_BASE.find("\n## 2.")
        relevant_sections.append(KNOWLEDGE_BASE[start:end].strip())

    return "\n\n".join(relevant_sections[:3])  # Limita a 3 seÃ§Ãµes para nÃ£o sobrecarregar
