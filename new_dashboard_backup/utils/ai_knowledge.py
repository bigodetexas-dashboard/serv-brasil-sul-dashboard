"""
BigodeBot AI - Base de Conhecimento Expandida
Conhecimento detalhado sobre o servidor, DayZ, regras e troubleshooting
"""

KNOWLEDGE_BASE = """
# CONHECIMENTO DO SERVIDOR BIGODE TEXAS

## 1. INFORMAÇÕES BÁSICAS DO SERVIDOR

### Configuração
- **Nome:** SERV. BRASIL SUL - XBOX
- **Mapa:** Chernarus (versão inverno/editada)
- **Plataforma:** Xbox Series X/S e Xbox One
- **Tipo:** PvP com zonas seguras
- **Moeda:** DZ Coins
- **Wipes:** A cada 30-45 dias (anunciado com antecedência)

### Horários de Pico
- Semana: 19h-23h (horário de Brasília)
- Fim de semana: 14h-02h
- Eventos especiais: Anunciados no Discord

## 2. SISTEMA DE ECONOMIA

### Como Ganhar DZ Coins
1. **Daily Reward:** 100 coins por dia (comando /daily)
2. **Kills PvP:** 50-150 coins por eliminação (varia com distância)
3. **Eventos:** 500-2000 coins (depende do evento)
4. **Missões:** 200-800 coins
5. **Venda de itens raros:** Negociável com players
6. **Bounties:** Eliminar alvos marcados (100-1000 coins)

### Loja (Shop)
- **Armas:** 500-3000 coins
- **Veículos:** 2000-8000 coins
- **Suprimentos:** 50-500 coins
- **Itens raros:** 1000-5000 coins
- **Entrega:** Até 30 segundos (sistema de fila)

### Banco do Clã
- Membros podem depositar coins
- Líder e moderadores podem sacar
- Usado para compras coletivas
- Histórico de transações disponível

## 3. SISTEMA DE CLÃS

### Criação de Clã
- Custo: 5000 DZ Coins
- Máximo de membros: 15
- Comando: /clan create [nome]

### Cargos
- **Líder:** Controle total, pode dissolver clã
- **Moderador:** Pode convidar/expulsar, gerenciar banco
- **Membro:** Pode depositar no banco, participar de guerras

### Guerras de Clã
- Desafio via comando /clan war [nome_do_clã]
- Duração: 7 dias
- Pontos por kill de membro rival
- Recompensa: 10.000 coins + título especial

### Territórios
- Clãs podem marcar bases no mapa
- Alarmes de invasão (notificação no Discord)
- Proteção limitada em horários específicos

## 4. REGRAS DO SERVIDOR

### Proibido (Ban Permanente)
1. **Glitches de base:** Entrar em bases por bugs
2. **Duplicação de itens:** Qualquer método
3. **Teaming excessivo:** Mais de 15 pessoas juntas
4. **Toxicidade extrema:** Racismo, homofobia, ameaças
5. **Alt accounts:** Para burlar bans ou farmar coins

### Permitido
1. **KOS (Kill on Sight):** Fora das zonas seguras
2. **Roubo de bases:** Desde que sem glitch
3. **Traição:** Faz parte do jogo
4. **Camping:** Estratégia válida
5. **Alianças temporárias:** Sem limite de tempo

### Zonas Seguras
- **Trader (Comerciante):** Não pode atacar/ser atacado
- **Spawn Points:** Proteção de 5 minutos
- **Eventos:** Definido pelo admin no momento

## 5. MECÂNICAS DO DAYZ (XBOX)

### Sobrevivência
- **Fome:** Come a cada 30-60 min (frutas, carne, latas)
- **Sede:** Bebe a cada 20-40 min (água, refrigerante)
- **Temperatura:** Roupas quentes no inverno, fogueira
- **Doenças:** Antibióticos para infecções, vitaminas para imunidade

### Combate
- **Headshot:** Dano crítico (maioria das armas = kill instantâneo)
- **Sangramento:** Use bandagens/trapos
- **Fratura:** Use tala (sticks + trapos)
- **Choque:** Epi-pen ou espere recuperar

### Veículos
- **Combustível:** Gasolina em postos ou barris
- **Reparos:** Precisa de peças específicas (roda, bateria, vela)
- **Dano:** Colisões causam dano ao jogador e veículo
- **Despawn:** Veículos sem uso por 7 dias desaparecem

### Bases
- **Construção:** Precisa de pregos, tábuas, martelo
- **Cadeados:** 3 dígitos (1000 combinações) ou 4 dígitos (10.000)
- **Raid:** Possível com ferramentas (alicate, serra, explosivos)
- **Despawn de loot:** Itens em tendas/barris duram 45 dias

## 6. LOCALIDADES IMPORTANTES (CHERNARUS)

### Zonas Militares (PvP Intenso)
- **NWAF (Northwest Airfield):** Melhor loot militar
- **NEAF (Northeast Airfield):** Loot médio, menos movimento
- **Tisy Military Base:** Loot top tier, muito perigoso
- **Kamensk Military Base:** Armas pesadas

### Cidades Grandes
- **Cherno:** Loot urbano, hospital
- **Elektro:** Spawn comum, hospital
- **Berezino:** Costa leste, loot médio
- **Novo:** Spawn comum, supermercados

### Pontos de Interesse
- **Green Mountain:** Torre de rádio, loot variado
- **Devil's Castle:** Loot militar leve
- **Zelenogorsk:** Cidade média, boa para começar

## 7. PERGUNTAS FREQUENTES (FAQ)

### "Como ganhar coins rápido?"
1. Faça o /daily todo dia (100 coins)
2. Participe de eventos (500-2000 coins)
3. Caçe bounties (100-1000 coins)
4. Faça kills em zonas militares (150 coins por kill)

### "Meu item não chegou da loja!"
- Sistema de fila: Entrega em até 30 segundos
- Se demorar mais: Verifique /delivery status
- Se falhar: Abre ticket (será entregue automaticamente)

### "Como entro em um clã?"
- Peça convite ao líder do clã
- Ou use /clan join [nome] se houver convite aberto

### "Posso ter mais de uma base?"
- Sim, sem limite
- Mas cada base precisa de manutenção (bandeiras)

### "O que fazer se morri injustamente?"
- Abra ticket com provas (vídeo/screenshot)
- Admins revisam em até 24h
- Compensação se confirmado bug/glitch

## 8. COMANDOS ÚTEIS

### Economia
- `/daily` - Resgatar recompensa diária
- `/balance` - Ver saldo de DZ Coins
- `/shop` - Abrir loja
- `/transfer [user] [valor]` - Transferir coins

### Clã
- `/clan create [nome]` - Criar clã (5000 coins)
- `/clan invite [user]` - Convidar membro
- `/clan bank` - Ver banco do clã
- `/clan war [clã]` - Desafiar para guerra

### Informações
- `/stats` - Ver suas estatísticas
- `/leaderboard` - Ver ranking
- `/help` - Lista de comandos
- `/ticket` - Abrir suporte

## 9. EVENTOS COMUNS

### Airdrop (Suprimento Aéreo)
- Acontece a cada 2-3 horas
- Loot militar de alto nível
- Anunciado no chat 5 min antes
- Localização aleatória

### King of the Hill
- Controle uma área por 30 min
- Recompensa: 2000 coins + loot especial
- Anunciado 10 min antes
- PvP liberado

### Treasure Hunt (Caça ao Tesouro)
- Pistas no Discord
- Primeiro a encontrar ganha 5000 coins
- Acontece 1x por semana

### Clan Wars Weekend
- Fim de semana de guerras
- Pontos em dobro
- Recompensas especiais

## 10. TROUBLESHOOTING

### "Não consigo conectar no servidor"
1. Reinicie o jogo
2. Verifique se o servidor está online (Discord)
3. Limpe cache do Xbox (Settings > Storage)
4. Reinstale DayZ se persistir

### "Meu personagem sumiu"
- Wipe recente? (Anunciado no Discord)
- Morreu e não lembra? (Cheque /stats)
- Bug raro: Abra ticket urgente

### "Fui banido injustamente"
- Leia as regras novamente
- Abra ticket de apelação
- Forneça provas (vídeos, prints)
- Admins revisam em 48h

### "Lag/Desync no servidor"
- Normal em horários de pico (19h-23h)
- Reinicie seu Xbox
- Use conexão cabeada (não Wi-Fi)
- Reporte se persistir por mais de 1h

## 11. DICAS AVANÇADAS

### Para Iniciantes
1. Spawne → Corra para cidade pequena
2. Pegue faca/machado primeiro (zumbis)
3. Encontre comida/água (prioridade)
4. Evite zonas militares no início
5. Faça amigos (Discord)

### Para Intermediários
1. Monte uma base pequena (escondida)
2. Faça rotas de loot eficientes
3. Participe de eventos
4. Entre em um clã
5. Aprenda PvP (treine em zonas militares)

### Para Avançados
1. Domine rotas de veículos
2. Lidere um clã
3. Participe de guerras
4. Faça raids estratégicos
5. Ajude novatos (ganhe respeito)

## 12. ATUALIZAÇÕES RECENTES

### Sistema de Fila de Entrega (NOVO!)
- Compras nunca mais serão perdidas
- Entrega garantida mesmo se FTP cair
- Status em tempo real via /delivery status

### IA com RAG (NOVO!)
- IA agora sabe sobre o jogo em tempo real
- Perguntas personalizadas com seus dados
- Respostas mais precisas e úteis

### Achievements System
- 18 conquistas disponíveis
- Recompensas em DZ Coins
- Progresso rastreado automaticamente
"""


def get_knowledge_context(question: str) -> str:
    """
    Retorna seções relevantes da base de conhecimento baseado na pergunta

    Args:
        question: Pergunta do usuário

    Returns:
        Contexto relevante da base de conhecimento
    """
    question_lower = question.lower()
    relevant_sections = []

    # Mapeamento de palavras-chave para seções
    keywords_map = {
        "coins|dinheiro|grana|saldo": "## 2. SISTEMA DE ECONOMIA",
        "clã|clan|grupo": "## 3. SISTEMA DE CLÃS",
        "regra|ban|proibido|permitido": "## 4. REGRAS DO SERVIDOR",
        "fome|sede|doença|sobreviv": "## 5. MECÂNICAS DO DAYZ",
        "local|cidade|mapa|onde": "## 6. LOCALIDADES IMPORTANTES",
        "como|ajuda|dúvida": "## 7. PERGUNTAS FREQUENTES",
        "comando|/": "## 8. COMANDOS ÚTEIS",
        "evento|airdrop|guerra": "## 9. EVENTOS COMUNS",
        "bug|erro|problema|não consigo": "## 10. TROUBLESHOOTING",
        "dica|iniciante|começar": "## 11. DICAS AVANÇADAS",
    }

    # Encontrar seções relevantes
    for keywords, section_title in keywords_map.items():
        if any(keyword in question_lower for keyword in keywords.split("|")):
            # Extrair seção do KNOWLEDGE_BASE
            start = KNOWLEDGE_BASE.find(section_title)
            if start != -1:
                # Encontrar próxima seção ou fim
                next_section = KNOWLEDGE_BASE.find("\n## ", start + 1)
                if next_section != -1:
                    section_content = KNOWLEDGE_BASE[start:next_section]
                else:
                    section_content = KNOWLEDGE_BASE[start:]

                relevant_sections.append(section_content.strip())

    # Se não encontrou nada específico, retorna informações básicas
    if not relevant_sections:
        start = KNOWLEDGE_BASE.find("## 1. INFORMAÇÕES BÁSICAS")
        end = KNOWLEDGE_BASE.find("\n## 2.")
        relevant_sections.append(KNOWLEDGE_BASE[start:end].strip())

    return "\n\n".join(relevant_sections[:3])  # Limita a 3 seções para não sobrecarregar
